<?php	session_start();	echo 'coucou';?><!DOCTYPE html><html><head>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <title>Culturemania - Inscription</title>	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>    <meta name="description" content="Site de la culture autour des jeux video, des livres et BD, des films et des séries TV, des lieux culturels, de la musique et des sites internet. Culturemania"/>    <meta name="keywords" content="jeux, jeu, video, livre, livres, film, films, serie, series, TV, télé, lieux, musique, album, artiste, concert, culture, mania, evenement, console, ps3, ps4, xbox, cinema, PC, actualité"/>    <meta property="og:image" content="http://www.culturemania.fr/assets/culturemania.jpg" />	<meta name="viewport" content="width=device-width">	<link rel="stylesheet" href="style.css"/>    <link rel="stylesheet" media="screen and (max-width: 1220px)" href="style-1200.css"/>    <link rel="stylesheet" media="screen and (max-width: 1020px)" href="style-1000.css"/>    <link rel="stylesheet" media="screen and (max-width: 620px)" href="style-600.css"/></head>    <body id="topanchor">	<div class="cm-margin-150"></div>    <?php      include 'connect.php';      setlocale (LC_TIME, 'fr_FR.utf8','fra');       include 'menu.php';    ?>	<section class="cm-section">        <div class="cm-main">            <div class="cm-glass-main">                <article class="cm-article">	                <H1>Formulaire d'inscription</H1>					<div class="cm-formulaire" id="formulaire">				<?php 										if(!empty($_POST) && empty($_POST['dontfuckwithme']))					{						$pseudo = strip_tags($_POST['pseudo']);						$name = strip_tags($_POST['name']);						$surname = strip_tags($_POST['surname']);						$website = strip_tags($_POST['website']);						$facebookpage = strip_tags($_POST['facebookpage']);						$twitterpage = strip_tags($_POST['twitterpage']);						$email = strip_tags($_POST['email']);						$password = strip_tags($_POST['password']);																	$date = date('Y-m-d H:i:s');												// On vérifie que cette adresse ne soit pas déjà utilisée						$query = 'SELECT COUNT(*) AS total FROM author WHERE EMAIL = \'' . $email .'\''; 						$res = $mysql->query($query);						$row = $res->fetch_assoc();						$count=$row['total']; 						$res->close();											if ($count > 0)						{							echo '<div class="cm-error-message">';							echo '<h3>Erreur : </h3>';							echo '<p>Cette adresse mail est déjà utilisée sur Culturemania.</p>';							echo '</div>';							}						else						{							$avatar_path = "";							if (!empty($_FILES) && !empty($_FILES['avatar']['tmp_name']))  							{								if ($_FILES['avatar']['error'] > UPLOAD_ERR_OK )								{									echo '<div class="cm-error-message">';									echo '<h3>Erreur : </h3>';									echo '<p>Le fichier sélectionné pour l\'avatar est trop gros. Veuillez sélectionner une image plus petite.</p>';									echo '</div>';										$bProceed = false;								}								else								{									$avatar_path = uploadImage($_FILES['avatar']['tmp_name'], 'assets/avatar/');								}							}							$cost = 10;							// Create a random salt							$salt = strtr(base64_encode(mcrypt_create_iv(16, MCRYPT_DEV_URANDOM)), '+', '.');							// Prefix information about the hash so PHP knows how to verify it later.							// "$2a$" Means we're using the Blowfish algorithm. The following two digits are the cost parameter.							$salt = sprintf("$2a$%02d$", $cost) . $salt;							$hashpass = crypt($password, $salt);														$sql="INSERT INTO author (NOM, PRENOM, PSEUDO, EMAIL, PASSWORD, SITEWEB, FACEBOOK, TWITTER, DATECREATION, ISADMIN, AVATAR) VALUES ('$name','$surname','$pseudo', '$email', '$hashpass', '$website' , '$facebookpage', '$twitterpage', '$date', 0, '$avatar_path')";							$mysql->query($sql);							if($mysql->insert_id > 0)							{								// Envoi du mail								$subject = "Confirmation d'inscription sur CultureMania";								$message = "<html><body>Bonjour ". $surname .", <BR><BR>Vous venez de vous inscrire sur CultureMania. Pour confirmer votre inscription, veuillez suivre le lien suivant : <a href=\"http://www.culturemania.fr/confirmation.php?email=".$email."\">http://www.culturemania.fr/confirmation.php?email=".$email."</a>								<BR><BR>								Rappel de vos identifiants : <BR>								login : ". $email ."<BR>								password : Vous seul le connaissez ! <BR><BR>																Merci de conserver cet email, et à très bientôt sur <a href=\"http://www.culturemania.fr\">http://www.culturemania.fr</a> ! <BR><BR>CultureMania)</body></html>";								$headers = 'From: CultureMania contact@culturemania.fr' . "\r\n" ;								$headers .='Reply-To: '. $email . "\r\n" ;								$headers .='X-Mailer: PHP/' . phpversion();								$headers  = 'MIME-Version: 1.0' . "\r\n";								$headers .= 'Content-type: text/html; charset=UTF-8' . "\r\n";								$headers .= 'From: CultureMania <contact@culturemania.fr>' . "\r\n";								if (!mail($email, $subject, $message, $headers))								{									echo '<div class="cm-error-message"><h3>Erreur interne :</h3><p>Envoi du mail impossible. Veuillez contacter Culturemania.</p></div>';								}								echo '<div class="cm-ok-message">';								echo '<h3>Utilisateur ajouté !</h3>';								echo '<p>Bienvenue sur <strong>www.culturemania.fr</strong> ! Vous devez confirmer votre inscription en cliquant sur le lien de confirmation présent dans le mail qui vient de vous être envoyé à l\'adresse '. $email . '.</p>';								echo '</div>';															}							else							{								echo '<div class="cm-error-message">';								echo '<h3>Erreur : </h3>';								echo '<p>Erreur de base de données.</p>';								echo '</div>';								}						}					}					?>									<div class="cm-separator-double"></div>					<form name="mainform" onsubmit="return validateForm()" method="POST" enctype="multipart/form-data">						<h3> Votre pseudo : (*) </h3>						<input type="text" name="pseudo" placeholder="Veuillez renseigner votre pseudo..." maxlength="128" >						<h3> Votre avatar :</h3>						<input type="file" name="avatar" id="avatarinput"  accept="image/*" value="Sélectionner un avatar"/>						<BR>						<h3> Votre nom :</h3>						<input type="text" name="name" placeholder="Veuillez renseigner votre nom..." maxlength="128">						<h3> Votre prénom :</h3>						<input type="text" name="surname" placeholder="Veuillez renseigner votre nom..." maxlength="128">						<h3> Votre site web :</h3>						<input type="text" name="website" placeholder="Veuillez renseigner votre site web si vous en possédez un..." maxlength="256">						<h3> Votre page Facebook :</h3>						<input type="text" name="facebookpage" placeholder="Veuillez renseigner l'adresse de votre page Facebook..." maxlength="128">						<h3> Votre page Tweeter :</h3>						<input type="text" name="twitterpage" placeholder="Veuillez renseigner l'adresse de votre page Twitter..." maxlength="128">						<h3> Votre e-mail : (*)</h3>						<input type="text" name="email" placeholder="Veuillez renseigner votre adresse e-mail..." maxlength="256">						<h3> Password : (*)</h3>						<input type="password" name="password" placeholder="Veuillez renseigner votre mot de passe..."  maxlength="128">						<h3> Veuillez ré-entrer votre Password : (*) </h3>						<input type="password" name="passwordBis" placeholder="Veuillez renseigner de nouveau votre mot de passe..." maxlength="128">						<input type="text" name="dontfuckwithme" class="cm-dontfuck">						<div class="divcenter">							<input type="submit" value="Valider mon inscription">						</div>					</form>									</div>			</article>		</div>	</div></section><BR><BR><section class="cm-section-100pc">    <BR>    <H1> Participer à Culturemania </H1>    <div class="cm-separator-double"></div>    <div class="cm-main">        <div class="cm-div-3">            <H1> S'inscrire</H1>            <a href="/Inscription"><img src="/assets/connect.png" alt="Inscription"/></a>            <BR><BR>            <p>Inscrivez-vous et prenez la plume pour publier vous-même des articles sur Culturemania ! On vous demandera le minimum : un pseudonyme, un e-mail valide et un mot de passe savament choisi. Le reste, c'est si uniquement si vous le décidez !</p>        </div><div class="cm-div-3">            <H1>Espace rédaction</H1>            <a href="/Espace-Redaction"><img src="/assets/pencil.png" alt="Redaction"/></a>            <BR><BR>            <p>Déjà inscrit ? Alors direction l'espace rédaction de Culturemania pour vous lancer et rédiger vos articles ! Textes, images, vidéo, citations, utilisez toutes les options disponibles pour donner à vos articles ce petit truc qui fait qu'on le lira jusqu'au bout !</p>           </div><div class="cm-div-3">            <H1>Informations</H1>            <a href="/A-propos"><img src="/assets/information.png" alt="A Propos"/></a>            <BR><BR>            <p>Vous voulez en savoir plus sur Culturemania et son mode de fonctionnement ? C'est par ici ! Tout a été fait pour se simplifier la vie au maximum. Nous avons fait le choix de vivre avec les machines alors autant que ce ne soit pas pour se pourrir la vie !</p>        </div>    </div>    <BR>    <BR></section><script>function validateEmail(email) {    var re = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;    return re.test(email);}function validateForm() {	formulaire = document.getElementById("formulaire");		topBody = document.getElementById("topanchor");		todestroy = document.getElementById("todestroy");		if (todestroy != null)		formulaire.removeChild(todestroy);	newDiv = document.createElement("div");    newDiv.id = "todestroy"    newDiv.className = "cm-error-message";    var value = document.forms["mainform"]["pseudo"].value;    if (value == null || value == "")     {    	newDiv.innerHTML =" Vous devez renseigner un pseudo.";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }        var value = document.forms["mainform"]["name"].value;    if (value == null || value == "")     {    	newDiv.innerHTML =" Vous devez renseigner un nom.";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }    var value = document.forms["mainform"]["surname"].value;    if (value == null || value == "")     {    	newDiv.innerHTML =" Vous devez renseigner un prénom.";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }    var value = document.forms["mainform"]["email"].value;    if (value == null || value == "" || !validateEmail(value))     {    	newDiv.innerHTML =" Vous devez renseigner un email valide.";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }    var value = document.forms["mainform"]["password"].value;    if (value == null || value == "")     {    	newDiv.innerHTML =" Vous devez renseigner un password";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }    var valuebis = document.forms["mainform"]["passwordBis"].value;    if (valuebis == null || valuebis == "" || value != valuebis )      {    	newDiv.innerHTML ="Les deux password ne correspondent pas.";    	formulaire.insertBefore(newDiv, formulaire.firstChild);    	topBody.scrollIntoView(true);        return false;    }        return true;}</script></body><?php	include 'footer.php';	$mysql->close();?></html>